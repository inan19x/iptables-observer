# Load kernel logging module if not already loaded
module(load="imklog")

# Log messages with our prefix to a dedicated file
:msg, contains, "IPTABLES-OBSERVER" /var/log/iptables-observer.log

# Forward to SIEM via TCP 514
:msg, contains, "IPTABLES-OBSERVER" @@SIEM_HOSTNAME:514

& stop
